<!DOCTYPE html>
<html>
<head>
	<title>WebGL Playground</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="gl.js"></script>
	<script src="Shaders.js"></script>
	<script>
		var gl;
		window.addEventListener("load", function(){
			gl= GLInstance("glcanvas"); // Init context
			gl.fSetSize(500,500); //Setting size
			gl.fClear(); //Reseting context

			//Shader steps
			// Get shaders texts
			var vShaderTxt = ShaderUtil.domShaderSrc("vertex_shader"), 
				fShaderTxt = ShaderUtil.domShaderSrc("fragment_shader"),

				//Compile shaders
				vShader = ShaderUtil.createShader(gl,vShaderTxt,gl.VERTEX_SHADER),
				fShader = ShaderUtil.createShader(gl,fShaderTxt, gl.FRAGMENT_SHADER),

				//Link shaders into program
				shaderProg = ShaderUtil.createProgram(gl,vShader,fShader,true);

			gl.useProgram(shaderProg);
			var aPositionLoc = gl.getAttribLocation(shaderProg,"a_position"),
				uPointSizeLoc = gl.getUniformLocation(shaderProg,"uPointSize");
			gl.useProgram(null);

			//data buffer setup
			var aryVerts = new Float32Array([0,0,0]),
				bufVerts = gl.createBuffer();

			gl.bindBuffer(gl.ARRAY_BUFFER, bufVerts);
			gl.bufferData(gl.ARRAY_BUFFER,aryVerts, gl.STATIC_DRAW);
			gl.bindBuffer(gl.ARRAY_BUFFER, null);

			//set up drawing
			gl.useProgram(shaderProg); //activate the shader
			gl.uniform1f(uPointSizeLoc,50.0); //store data to the shader's uniform variable

			gl.bindBuffer(gl.ARRAY_BUFFER, bufVerts);
			gl.enableVertexAttribArray(aPositionLoc);
			gl.vertexAttribPointer(aPositionLoc,3,gl.FLOAT,false,0,0);
			gl.bindBuffer(gl.ARRAY_BUFFER, null);

			this.gl.drawArrays(gl.POINTS, 0, 1);
		});
	</script>
</head>
<body>
	<div>
		<canvas id="glcanvas"></canvas>
	</div>
	<script id="vertex_shader" type="x-shader/x-vertex">#version 300 es
		in vec3 a_position;

		uniform float uPointSize;

		void main(void){
		gl_PointSize = uPointSize;
		gl_Position = vec4(a_position, 1.0);
	}
	</script>
	<script id="fragment_shader" type="x-shader/x-fragment">#version 300 es
		precision mediump float;
		
		out vec4 finalColor;

		void main(void){
		finalColor = vec4(0.0,0.0,0.0,1.0);
	}
	</script>
</body>
</html>